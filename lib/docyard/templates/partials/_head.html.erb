<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="<%= @site_description %>">
<meta name="view-transition" content="same-origin">
<title><%= @page_title %> | <%= @site_title %></title>
<link rel="icon" href="<%= asset_path(@favicon) %>" type="image/svg+xml">

<% if @og_enabled %>
<link rel="canonical" href="<%= @og_url %>">

<meta property="og:type" content="website">
<meta property="og:site_name" content="<%= @site_title %>">
<meta property="og:title" content="<%= @page_title %>">
<meta property="og:url" content="<%= @og_url %>">
<% if @og_description && !@og_description.empty? %>
<meta property="og:description" content="<%= @og_description %>">
<% end %>
<% if @og_image %>
<meta property="og:image" content="<%= @og_image %>">
<% end %>

<meta name="twitter:card" content="<%= @og_image ? 'summary_large_image' : 'summary' %>">
<meta name="twitter:title" content="<%= @page_title %>">
<% if @og_description && !@og_description.empty? %>
<meta name="twitter:description" content="<%= @og_description %>">
<% end %>
<% if @og_image %>
<meta name="twitter:image" content="<%= @og_image %>">
<% end %>
<% if @og_twitter %>
<meta name="twitter:site" content="@<%= @og_twitter.delete_prefix('@') %>">
<% end %>
<% end %>

<link rel="preload" href="<%= asset_path('_docyard/fonts/Inter-Variable.ttf') %>" as="font" type="font/ttf" crossorigin>

<%= render_partial('_icon_library') %>

<script>
  (function() {
    var html = document.documentElement;

    html.classList.add('no-transition');

    var theme = localStorage.getItem('theme') ||
                (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    html.classList.toggle('dark', theme === 'dark');

    if (localStorage.getItem('docyard_sidebar_collapsed') === 'true') {
      html.classList.add('sidebar-collapsed');
    }

    var BANNER_KEY = 'docyard-announcement-dismissed';
    try {
      var dismissed = localStorage.getItem(BANNER_KEY);
      if (dismissed) {
        var dismissedAt = parseInt(dismissed, 10);
        var sevenDaysAgo = Date.now() - (7 * 24 * 60 * 60 * 1000);
        if (dismissedAt > sevenDaysAgo) {
          html.classList.add('banner-dismissed');
        }
      }
    } catch (e) {}

    requestAnimationFrame(function() {
      requestAnimationFrame(function() {
        html.classList.remove('no-transition');
      });
    });
  })();
</script>

<link rel="stylesheet" href="/_docyard/css/main.css">

<% if @primary_color && (@primary_color[:light] || @primary_color[:dark]) %>
<style>
<% light_color = @primary_color[:light] %>
<% dark_color = @primary_color[:dark] || light_color %>
<% if light_color %>
:root {
  --primary: <%= light_color %>;
  --sidebar-primary: <%= light_color %>;
}
.dark {
  --primary: <%= dark_color %>;
  --sidebar-primary: <%= dark_color %>;
}
<% elsif dark_color %>
.dark {
  --primary: <%= dark_color %>;
  --sidebar-primary: <%= dark_color %>;
}
<% end %>
</style>
<% end %>

<%= render_partial('_analytics') %>
